<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lost Underground - Загрузка</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: rgb(11, 11, 11);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            color: white;
            position: relative;
        }

        .background-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }

        .bg-image-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .bg-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0;
            transition: opacity 3s ease-in-out;
        }

        .bg-image.active {
            opacity: 0.4;
        }

        .bg-overlay-dark {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg,
                rgba(11, 11, 11, 0.85) 0%,
                rgba(25, 25, 25, 0.75) 50%,
                rgba(11, 11, 11, 0.85) 100%
            );
            z-index: 2;
        }

        .bg-overlay-gradient {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(
                ellipse at center,
                rgba(25, 25, 25, 0.3) 0%,
                rgba(11, 11, 11, 0.8) 70%,
                rgb(11, 11, 11) 100%
            );
            z-index: 3;
            animation: gradientPulse 8s ease-in-out infinite;
        }

        .grid-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.015) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.015) 1px, transparent 1px);
            background-size: 60px 60px;
            z-index: 4;
            opacity: 0.5;
            pointer-events: none;
        }

        .vignette {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            box-shadow: inset 0 0 200px rgba(0, 0, 0, 0.8);
            z-index: 5;
            pointer-events: none;
        }

        .main-content {
            position: relative;
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100vw;
            padding: 40px;
        }

        .spinner-wrapper {
            position: relative;
            margin-bottom: 50px;
            animation: fadeInScale 1.5s ease-out forwards;
            transform: translateY(-40px);
        }

        .spinner-glow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            background: radial-gradient(
                circle,
                rgba(255, 255, 255, 0.15) 0%,
                transparent 70%
            );
            border-radius: 50%;
            animation: glowPulse 3s ease-in-out infinite;
            z-index: 1;
        }

        .spinner-outer {
            position: relative;
            width: 150px;
            height: 150px;
            border: 3px solid rgba(255, 255, 255, 0.05);
            border-top: 3px solid rgba(255, 255, 255, 0.8);
            border-right: 3px solid rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            animation: spinRotate 2s linear infinite;
            z-index: 2;
            background: rgba(25, 25, 25, 0.4);
            box-shadow: 
                0 0 30px rgba(0, 0, 0, 0.5),
                inset 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .spinner-middle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 130px;
            height: 130px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            background: rgba(11, 11, 11, 0.6);
            box-shadow: 
                inset 0 0 30px rgba(0, 0, 0, 0.8),
                0 0 20px rgba(255, 255, 255, 0.1);
            z-index: 3;
        }

        .spinner-inner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(25, 25, 25, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            box-shadow: 
                inset 0 0 20px rgba(0, 0, 0, 0.9),
                0 0 15px rgba(255, 255, 255, 0.15);
            z-index: 4;
        }

        .logo-image {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            object-fit: cover;
            filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.3));
            animation: logoFloat 4s ease-in-out infinite;
        }

        .spinner-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 165px;
            height: 165px;
            border: 2px solid transparent;
            border-top: 2px solid rgba(255, 255, 255, 0.3);
            border-left: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            animation: spinRotateReverse 3s linear infinite;
            z-index: 1;
        }

        .title-section {
            text-align: center;
            margin-bottom: 60px;
            animation: fadeInUp 1.2s ease-out 0.3s both;
        }

        .main-title {
            font-size: 56px;
            font-weight: 700;
            color: white;
            letter-spacing: 6px;
            margin-bottom: 12px;
            text-shadow: 
                0 0 20px rgba(255, 255, 255, 0.3),
                0 4px 10px rgba(0, 0, 0, 0.8);
            background: linear-gradient(
                135deg,
                rgba(255, 255, 255, 1) 0%,
                rgba(200, 200, 200, 1) 100%
            );
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 20px;
            font-weight: 400;
            color: rgba(255, 255, 255, 0.8);
            letter-spacing: 3px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.6);
        }

        .status-container {
            width: 90%;
            max-width: 1000px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 18px;
            padding: 30px;
            background: linear-gradient(
                145deg,
                rgba(25, 25, 25, 0.3) 0%,
                rgba(11, 11, 11, 0.5) 100%
            );
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 
                0 10px 50px rgba(0, 0, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
            animation: fadeInUp 1.5s ease-out 0.6s both;
        }

        .status-line {
            color: white;
            text-align: center;
            transition: all 0.5s ease;
            letter-spacing: 1.5px;
            line-height: 1.4;
            text-shadow: 0 2px 6px rgba(0, 0, 0, 0.5);
            opacity: 0;
            animation: statusSlideIn 0.6s ease-out forwards;
            word-wrap: break-word;
            max-width: 100%;
        }

        .status-line:nth-child(1) {
            font-size: 13px;
            opacity: 0.35;
            font-weight: 300;
            animation-delay: 0s;
        }

        .status-line:nth-child(2) {
            font-size: 15px;
            opacity: 0.45;
            font-weight: 300;
            animation-delay: 0.1s;
        }

        .status-line:nth-child(3) {
            font-size: 18px;
            opacity: 0.65;
            font-weight: 400;
            animation-delay: 0.2s;
        }

        .status-line:nth-child(4) {
            font-size: 22px;
            opacity: 0.85;
            font-weight: 500;
            animation-delay: 0.3s;
        }

        .status-line:nth-child(5) {
            font-size: 28px;
            opacity: 1;
            font-weight: 600;
            animation-delay: 0.4s;
            text-shadow: 
                0 0 15px rgba(255, 255, 255, 0.4),
                0 4px 10px rgba(0, 0, 0, 0.8);
        }

        @keyframes gradientPulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.8;
            }
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: translateY(-40px) scale(0.8);
            }
            to {
                opacity: 1;
                transform: translateY(-40px) scale(1);
            }
        }

        @keyframes spinRotate {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        @keyframes spinRotateReverse {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }
            100% {
                transform: translate(-50%, -50%) rotate(-360deg);
            }
        }

        @keyframes glowPulse {
            0%, 100% {
                opacity: 0.5;
                transform: translate(-50%, -50%) scale(1);
            }
            50% {
                opacity: 0.8;
                transform: translate(-50%, -50%) scale(1.1);
            }
        }

        @keyframes logoFloat {
            0%, 100% {
                transform: translateY(0) scale(1);
            }
            50% {
                transform: translateY(-3px) scale(1.05);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes statusSlideIn {
            from {
                opacity: 0;
                transform: translateX(-30px);
                filter: blur(5px);
            }
            to {
                opacity: var(--final-opacity, 1);
                transform: translateX(0);
                filter: blur(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeOutAll {
            to {
                opacity: 0;
                transform: scale(0.95);
            }
        }

        .fade-out {
            animation: fadeOutAll 1.2s ease-out forwards;
        }

        @media (max-width: 768px) {
            .main-title {
                font-size: 38px;
                letter-spacing: 4px;
            }

            .subtitle {
                font-size: 16px;
            }

            .spinner-outer {
                width: 120px;
                height: 120px;
            }

            .spinner-middle {
                width: 100px;
                height: 100px;
            }

            .spinner-inner {
                width: 75px;
                height: 75px;
            }

            .logo-image {
                width: 65px;
                height: 65px;
            }

            .status-line:nth-child(1) { font-size: 11px; }
            .status-line:nth-child(2) { font-size: 13px; }
            .status-line:nth-child(3) { font-size: 15px; }
            .status-line:nth-child(4) { font-size: 18px; }
            .status-line:nth-child(5) { font-size: 22px; }
        }
    </style>
</head>
<body>
    <div class="background-layer">
        <div class="bg-image-container">
            <div class="bg-image" id="bgImage1"></div>
            <div class="bg-image" id="bgImage2"></div>
            <div class="bg-image" id="bgImage3"></div>
        </div>
        <div class="bg-overlay-dark"></div>
        <div class="bg-overlay-gradient"></div>
        <div class="grid-pattern"></div>
        <div class="vignette"></div>
    </div>

    <div class="main-content">
        <div class="spinner-wrapper">
            <div class="spinner-glow"></div>
            <div class="spinner-ring"></div>
            <div class="spinner-outer">
                <div class="spinner-middle">
                    <div class="spinner-inner">
                        <img src="https://cdn.discordapp.com/attachments/1373657384798388265/1442422579607633921/1mb.png?ex=69256035&is=69240eb5&hm=c54cd16adc755b9512aa9503530b68071f5f450321b084f10e2fefc266443829&" 
                             alt="Logo" 
                             class="logo-image"
                             onerror="this.style.display='none'">
                    </div>
                </div>
            </div>
        </div>

        <div class="title-section">
            <h1 class="main-title">LOST UNDERGROUND</h1>
            <p class="subtitle">подземное выживание</p>
        </div>

        <div class="status-container" id="statusContainer">
            <div class="status-line">Подготовка</div>
            <div class="status-line">Подключение к серверу</div>
            <div class="status-line">Инициализация</div>
            <div class="status-line">Загрузка ресурсов</div>
            <div class="status-line">Ожидание</div>
        </div>
    </div>

    <script>
        let statusHistory = [
            'Подготовка',
            'Подключение к серверу',
            'Инициализация',
            'Загрузка ресурсов',
            'Ожидание'
        ];

        let currentProgress = 0;
        let filesDownloaded = 0;
        let filesTotal = 0;
        let isGmodActive = false;
        let backgroundIndex = 0;

        const backgroundImages = [
            'https://garry-s-mod.ru/wp-content/uploads/2022/02/24787.jpg',
            'https://garry-s-mod.ru/wp-content/uploads/2020/09/35878.jpg',
            'https://garry-s-mod.ru/wp-content/uploads/2020/09/14656.jpg'
        ];

        const bgElements = [
            document.getElementById('bgImage1'),
            document.getElementById('bgImage2'),
            document.getElementById('bgImage3')
        ];

        function initBackgrounds() {
            bgElements.forEach((element, index) => {
                if (element && backgroundImages[index]) {
                    element.style.backgroundImage = `url('${backgroundImages[index]}')`;
                }
            });

            if (bgElements[0]) {
                bgElements[0].classList.add('active');
            }
        }

        function changeBackground() {
            bgElements.forEach(bg => {
                if (bg) bg.classList.remove('active');
            });

            backgroundIndex = (backgroundIndex + 1) % bgElements.length;

            if (bgElements[backgroundIndex]) {
                bgElements[backgroundIndex].classList.add('active');
            }
        }

        function updateStatusDisplay(newStatus) {
            if (!newStatus) return;

            statusHistory.push(newStatus);

            if (statusHistory.length > 5) {
                statusHistory.shift();
            }

            const container = document.getElementById('statusContainer');
            if (!container) return;

            container.innerHTML = '';

            statusHistory.forEach((status, index) => {
                const line = document.createElement('div');
                line.className = 'status-line';

                const maxLength = 65;
                const displayStatus = status.length > maxLength 
                    ? status.substring(0, maxLength - 3) 
                    : status;

                line.textContent = displayStatus;

                const opacities = [0.35, 0.45, 0.65, 0.85, 1];
                line.style.setProperty('--final-opacity', opacities[index] || 1);

                container.appendChild(line);
            });
        }

        const autoStatuses = [
            'Подключение к серверу',
            'Получение информации о сервере',
            'Синхронизация данных',
            'Загрузка конфигурации',
            'Получение списка файлов',
            'Загрузка карты',
            'Загрузка моделей',
            'Загрузка текстур',
            'Загрузка материалов',
            'Загрузка звуков',
            'Загрузка скриптов',
            'Подготовка игрового мира',
            'Инициализация системы',
            'Проверка целостности файлов',
            'Оптимизация ресурсов',
            'Финальная подготовка'
        ];

        let autoStatusIndex = 0;

        function autoUpdateStatus() {
            if (!isGmodActive && currentProgress < 95) {
                const status = autoStatuses[autoStatusIndex % autoStatuses.length];
                updateStatusDisplay(status);
                autoStatusIndex++;
            }
        }

        function GameDetails(servername, serverurl, mapname, maxplayers, steamid, gamemode) {
            isGmodActive = true;

            if (servername) {
                updateStatusDisplay('Подключено к: ' + servername);
            }

            if (mapname) {
                updateStatusDisplay('Карта: ' + mapname);
            }

            if (gamemode) {
                updateStatusDisplay('Режим игры: ' + gamemode);
            }
        }

        function SetStatusChanged(status) {
            isGmodActive = true;

            if (status) {
                updateStatusDisplay(status);
            }
        }

        function DownloadingFile(fileName) {
            isGmodActive = true;

            if (fileName) {
                const pathParts = fileName.split('/');
                const shortName = pathParts[pathParts.length - 1];
                
                const displayName = shortName.length > 45 
                    ? shortName.substring(shortName.length - 42) 
                    : shortName;

                updateStatusDisplay('Загрузка: ' + displayName);
            }
        }

        function SetFilesNeeded(needed) {
            isGmodActive = true;
            filesTotal = parseInt(needed) || 0;
            updateStatusDisplay('Необходимо загрузить файлов: ' + needed);
        }

        function SetFilesTotal(total) {
            isGmodActive = true;
            filesTotal = parseInt(total) || 0;
            updateStatusDisplay('Всего файлов: ' + total);
        }

        function SetFilesDownloaded(downloaded) {
            isGmodActive = true;
            filesDownloaded = parseInt(downloaded) || 0;
        }

        function SetLoadProgress(progress) {
            isGmodActive = true;
            currentProgress = parseFloat(progress) || 0;

            if (currentProgress > 100) {
                currentProgress = 100;
            }

            if (currentProgress >= 100) {
                updateStatusDisplay('Загрузка завершена');
                
                setTimeout(() => {
                    const mainContent = document.querySelector('.main-content');
                    if (mainContent) {
                        mainContent.classList.add('fade-out');
                    }

                    setTimeout(() => {
                        document.body.style.display = 'none';
                    }, 1200);
                }, 800);
            } else {
                updateStatusDisplay(`Загрузка ${Math.floor(currentProgress)}%`);
            }
        }

        function initialize() {
            console.log('Lost Underground - Загрузка инициализирована');

            initBackgrounds();

            setInterval(changeBackground, 7000);

            setInterval(autoUpdateStatus, 3500);

            setTimeout(() => {
                if (!isGmodActive) {
                    updateStatusDisplay('Установка соединения');
                }
            }, 1500);

            setTimeout(() => {
                if (!isGmodActive) {
                    updateStatusDisplay('Получение данных сервера');
                }
            }, 4000);
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initialize);
        } else {
            initialize();
        }

        window.addEventListener('error', function(e) {
            if (e.target.tagName === 'IMG') {
                console.warn('Не удалось загрузить изображение:', e.target.src);
            }
        }, true);

    </script>
</body>
</html>
